<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sunny Medicoze</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
body{background:#f8f9fa;color:#333;}
header{background:white;padding:15px 20px;display:flex;justify-content:space-between;align-items:center;position:fixed;width:100%;top:0;box-shadow:0 2px 10px rgba(0,0,0,0.1);z-index:1000;}
.logo{font-weight:600;font-size:20px;}
.admin-btn{background:#2d3436;color:white;border:none;padding:6px 12px;border-radius:6px;cursor:pointer;}

.hero{margin-top:70px;height:35vh;background:url('https://i.ibb.co/93fd92Mf/Screenshot-2026-03-01-035001.png') center/cover no-repeat;display:flex;align-items:center;justify-content:center;color:white;position:relative;text-align:center;}
.hero::after{content:"";position:absolute;width:100%;height:100%;background:rgba(0,0,0,0.5);top:0;left:0;}
.hero-content{position:relative;z-index:2;}

.products{padding:60px 20px;}
.search-bar{width:100%;max-width:400px;padding:10px;margin-bottom:20px;border-radius:8px;border:1px solid #ccc;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;}

.product{background:white;border-radius:15px;padding:15px;box-shadow:0 5px 15px rgba(0,0,0,0.1);text-align:center;}
.product img{width:100%;height:170px;object-fit:cover;border-radius:10px;}
.product button{margin-top:10px;width:100%;padding:10px;background:#0984e3;color:white;border:none;border-radius:8px;cursor:pointer;}
.product button:disabled{background:gray;}
.low-stock{color:red;font-size:12px;margin-top:5px;}

.cart-icon{position:fixed;bottom:80px;right:20px;background:#ff4757;width:55px;height:55px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-size:20px;cursor:pointer;z-index:1001;}
.cart-count{position:absolute;top:-5px;right:-5px;background:black;color:white;font-size:12px;padding:3px 6px;border-radius:50%;}

.overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.4);display:none;z-index:1500;}
.overlay.active{display:block;}

.cart-drawer{position:fixed;right:-420px;top:0;width:400px;height:100%;background:white;box-shadow:-5px 0 20px rgba(0,0,0,0.2);transition:0.3s;padding:20px;overflow-y:auto;z-index:2000;}
.cart-drawer.active{right:0;}

.cart-item{background:#f1f3f6;padding:12px;border-radius:10px;margin-bottom:12px;line-height:1.6;}
.qty-btn{padding:4px 8px;margin:0 5px;background:#0984e3;color:white;border:none;border-radius:5px;cursor:pointer;}
.summary{margin-top:15px;padding-top:10px;border-top:1px solid #ccc;line-height:1.8;}
.save-msg{color:#27ae60;font-weight:600;margin-top:5px;}
.clear-btn{background:#d63031;color:white;border:none;padding:6px 10px;border-radius:6px;margin-top:10px;cursor:pointer;}
.send-btn{background:#00b894;color:white;padding:10px;border:none;width:100%;border-radius:8px;cursor:pointer;margin-top:10px;}
.cart-drawer input{width:100%;padding:8px;margin-top:8px;border-radius:6px;border:1px solid #ccc;}

.admin-panel{position:fixed;top:0;left:-380px;width:380px;height:100%;background:white;box-shadow:5px 0 20px rgba(0,0,0,0.2);padding:20px;transition:0.3s;z-index:3000;overflow:auto;}
.admin-panel.active{left:0;}
.admin-close{cursor:pointer;color:red;font-weight:bold;margin-bottom:10px;}
.admin-panel input{width:100%;padding:8px;margin-bottom:10px;}
.inventory-item{border-bottom:1px solid #ddd;padding:10px 0;}
.inventory-item img{width:60px;height:60px;object-fit:cover;border-radius:8px;}
.analytics-box{background:#f1f3f6;padding:10px;border-radius:8px;margin-top:10px;}
</style>
</head>
<body>

<header>
<div class="logo">Sunny Medicoze</div>
<button class="admin-btn" onclick="toggleAdmin()">Admin</button>
</header>

<div class="admin-panel" id="adminPanel">
<div class="admin-close" onclick="toggleAdmin()">âœ• Close</div>
<h3>Admin Panel</h3>
<input type="password" id="adminPass" placeholder="Password">
<button onclick="loginAdmin()">Login</button>
<div id="adminControls" style="display:none;">
<h4>Add Product</h4>
<input type="text" id="newName" placeholder="Name">
<input type="number" id="newPrice" placeholder="Price">
<input type="number" id="newStock" placeholder="Stock">
<input type="file" id="newImage">
<button onclick="addProduct()">Add</button>
<h4 style="margin-top:15px;">Inventory</h4>
<div id="inventoryList"></div>
<h4 style="margin-top:15px;">Order History</h4>
<div id="orderHistory"></div>
<h4 style="margin-top:15px;">Sales Analytics</h4>
<div class="analytics-box" id="analyticsBox"></div>
</div>
</div>

<section class="hero"><div class="hero-content"><h1>Your Trusted Medical Store</h1></div></section>

<section class="products">
<h2>Our Products</h2>
<input type="text" id="searchInput" class="search-bar" placeholder="Search..." onkeyup="searchProducts()">
<div class="grid" id="productGrid"></div>
</section>

<div class="cart-icon" onclick="openCart()">ðŸ›’
<div class="cart-count" id="cartCount">0</div>
</div>

<div class="overlay" id="overlay" onclick="closeCart()"></div>

<div class="cart-drawer" id="cartDrawer">
<h3>Your Cart</h3>
<div id="cartItems"></div>
<input type="text" id="custName" placeholder="Your Name">
<input type="text" id="custPhone" placeholder="Phone Number">
<input type="text" id="custAddress" placeholder="Delivery Address">
<button class="clear-btn" onclick="clearCart()">Clear Cart</button>
<button class="send-btn" onclick="sendOrder()">Send Order</button>
</div>

<script>
let cart = [];
let orders = [];
let totalRevenue = 0;
let totalDiscount = 0;
let totalDelivery = 0;
let productSales = {};

let products = [
  {name:"WHISPER CHOICE ULTRA XL PLUS 15 PADS",price:190,stock:10,image:"https://i.ibb.co/tnfsXrv/Screenshot-28-2-2026-9818-www-bing-com.jpg"},
  {name:"SMART AND HANDSOME FW 150 GM",price:290,stock:5,image:"https://i.ibb.co/V0QyR8CV/Screenshot-2026-02-28-113859.png"},
  {name:"LIPTON GREEN TEA HONEY LEMON 25 BAGS",price:170,stock:8,image:"https://i.ibb.co/TM757M6Z/Screenshot-2026-02-28-114158.png"},
  {name:"NOT OUT ADULT DIAPER M SIZE 10 PIECES PACK",price:299,stock:3,image:"https://i.ibb.co/ymr6DgzW/Screenshot-2026-02-28-114541.png"}
];

function renderProducts() {
  productGrid.innerHTML = "";
  products.forEach((p, i) => {
    let msg = "";
    if (p.stock <= 0) msg = "<div class='low-stock'>Out of Stock</div>";
    else if (p.stock <= 3) msg = "<div class='low-stock'>Only " + p.stock + " left</div>";
    productGrid.innerHTML += `
      <div class="product">
        <img src="${p.image}">
        <h4>${p.name}</h4>
        <p>â‚¹${p.price}</p>
        ${msg}
        <button ${p.stock <= 0 ? "disabled" : ""} onclick="addToCart(${i})">Add to Cart</button>
      </div>`;
  });
}
renderProducts();

function addToCart(i) {
  let p = products[i];
  if (p.stock <= 0) return;
  let ex = cart.find(x => x.index === i);
  if (ex && ex.qty >= 3) { alert("Max 3 allowed"); return; }
  if (ex) ex.qty++;
  else cart.push({index: i, qty: 1});
  p.stock--;
  updateCart();
  renderProducts();
}

function calculatePricing(subtotal) {
  let discount = 0;
  let discountPercent = 0;
  let discountLabel = "";

  if (subtotal < 699) {
    // no discount
  } else if (subtotal < 899) {
    let target = Math.ceil(subtotal * 0.90);
    discount = subtotal - target;
    discountPercent = (discount / subtotal) * 100;
    if (discountPercent < 9) {
      target = Math.ceil(subtotal * 0.91);
      discount = subtotal - target;
      discountPercent = (discount / subtotal) * 100;
    }
    discountLabel = discountPercent.toFixed(1) + "%";
  } else {
    discount = Math.min(Math.floor(subtotal * 0.10), 100);
    discountPercent = (discount / subtotal) * 100;
    discountLabel = "10% (max â‚¹100)";
  }

  let afterDiscount = subtotal - discount;

  let delivery = 0;
  let deliveryLabel = "";
  let deliverySaved = 0;

  if (subtotal <= 399) {
    delivery = 0;
    deliveryLabel = "â€”";
  } else if (subtotal <= 699) {
    delivery = 40;
    deliveryLabel = "â‚¹40";
    deliverySaved = 0;
  } else {
    if (afterDiscount >= 699) {
      delivery = 0;
      deliveryLabel = "Free";
      deliverySaved = 40;
    } else {
      delivery = 20;
      deliveryLabel = "â‚¹20";
      deliverySaved = 20;
    }
  }

  let final = afterDiscount + delivery;

  return {
    subtotal,
    discount: Math.round(discount),
    discountPercent: discountPercent.toFixed(1),
    discountLabel,
    afterDiscount: Math.round(afterDiscount),
    delivery,
    deliveryLabel,
    deliverySaved,
    final: Math.round(final),
    canOrder: subtotal > 399,
    totalSaved: Math.round(discount) + deliverySaved
  };
}

function updateCart() {
  cartCount.innerText = cart.reduce((t, i) => t + i.qty, 0);

  let subtotal = 0;
  let html = "";

  cart.forEach((item, idx) => {
    let p = products[item.index];
    let itemTotal = p.price * item.qty;
    subtotal += itemTotal;
    html += `<div class="cart-item">
      ${p.name}<br>
      <button class="qty-btn" onclick="decrease(${idx})">-</button>
      ${item.qty}
      <button class="qty-btn" onclick="increase(${idx})">+</button>
      = â‚¹${itemTotal}
    </div>`;
  });

  const p = calculatePricing(subtotal);

  let discountLine = p.discount > 0
    ? `Discount (${p.discountLabel}): -â‚¹${p.discount}<br>`
    : "";

  let deliveryLine = p.deliveryLabel === "Free"
    ? `<span style="color:#27ae60">Free Delivery</span><br>`
    : `Delivery: ${p.deliveryLabel}<br>`;

  let saveMsg = "";
  if (p.totalSaved > 0) {
    saveMsg = `<div class="save-msg">
      ðŸŽ‰ Total Saved: â‚¹${p.totalSaved}<br>
      (Discount: â‚¹${p.discount}${p.deliverySaved > 0 ? " + Delivery: â‚¹" + p.deliverySaved : ""})
    </div>`;
  }

  let warning = !p.canOrder
    ? `<div style="color:#e74c3c; margin:10px 0; font-weight:500;">Minimum order â‚¹400 required</div>`
    : "";

  html += `
    <div class="summary">
      Subtotal: â‚¹${subtotal}<br>
      ${discountLine}
      ${deliveryLine}
      <b>Final Amount: â‚¹${p.final}</b>
      ${saveMsg}
      ${warning}
    </div>`;

  cartItems.innerHTML = html;
}

function increase(i) {
  let item = cart[i], p = products[item.index];
  if (item.qty >= 3) { alert("Max 3 allowed"); return; }
  if (p.stock <= 0) return;
  item.qty++;
  p.stock--;
  updateCart();
  renderProducts();
}

function decrease(i) {
  let item = cart[i], p = products[item.index];
  item.qty--;
  p.stock++;
  if (item.qty <= 0) cart.splice(i, 1);
  updateCart();
  renderProducts();
}

function clearCart() {
  cart.forEach(item => products[item.index].stock += item.qty);
  cart = [];
  updateCart();
  renderProducts();
}

function sendOrder() {
  let name = custName.value.trim();
  let phone = custPhone.value.trim();
  let address = custAddress.value.trim();

  if (!name || !phone || !address) {
    alert("Please fill your name, phone and delivery address");
    return;
  }

  if (cart.length === 0) {
    alert("Your cart is empty");
    return;
  }

  let subtotal = cart.reduce((t, i) => t + products[i.index].price * i.qty, 0);

  const p = calculatePricing(subtotal);

  if (!p.canOrder) {
    alert("Minimum order subtotal is â‚¹400");
    return;
  }

  let orderId = "SM" + Date.now();
  let now = new Date().toLocaleString();

  orders.push({id: orderId, total: p.final});
  totalRevenue += p.final;
  totalDiscount += p.discount;
  totalDelivery += p.delivery;

  cart.forEach(i => {
    let n = products[i.index].name;
    productSales[n] = (productSales[n] || 0) + i.qty;
  });

  renderAnalytics();
  renderOrders();

  let msg = "ðŸ§¾ *Sunny Medicoze Order*%0A%0A";
  msg += `Order ID: ${orderId}%0A`;
  msg += `Date: ${now}%0A%0A`;
  msg += `Name: ${name}%0A`;
  msg += `Phone: ${phone}%0A`;
  msg += `Address: ${address}%0A%0A`;

  cart.forEach(i => msg += `${products[i.index].name} x${i.qty}%0A`);

  msg += "%0A";
  msg += `Subtotal: â‚¹${subtotal}%0A`;
  if (p.discount > 0) msg += `Discount (${p.discountLabel}): -â‚¹${p.discount}%0A`;
  msg += `Delivery: â‚¹${p.delivery}`;
  if (p.delivery === 0) msg += " (Free)";
  if (p.delivery === 20) msg += " (reduced)";
  msg += "%0A";
  msg += `ðŸ’° *Final Payable: â‚¹${p.final}*%0A%0A`;
  if (p.totalSaved > 0) {
    msg += `ðŸŽ‰ Total Saved Today: â‚¹${p.totalSaved} (Discount + Delivery)%0A`;
  }
  msg += "Thank you for shopping with Sunny Medicoze! ðŸ™";

  window.open("https://wa.me/919817824881?text=" + msg, "_blank");

  clearCart();
  closeCart();
}

function renderOrders() {
  orderHistory.innerHTML = orders.map(o => `Order ${o.id} - â‚¹${o.total}<br>`).join("");
}

function renderAnalytics() {
  let best = "None";
  let maxSales = 0;
  Object.keys(productSales).forEach(n => {
    if (productSales[n] > maxSales) {
      maxSales = productSales[n];
      best = n;
    }
  });
  analyticsBox.innerHTML = `
    Total Orders: ${orders.length}<br>
    Total Revenue: â‚¹${totalRevenue}<br>
    Total Discount Given: â‚¹${totalDiscount}<br>
    Total Delivery Collected: â‚¹${totalDelivery}<br>
    Best Selling Product: ${best}
  `;
}

function toggleAdmin() { adminPanel.classList.toggle("active"); }

function loginAdmin() {
  if (adminPass.value === "sunnyadmin") {
    adminControls.style.display = "block";
    renderInventory();
    renderAnalytics();
    renderOrders();
  } else {
    alert("Incorrect password");
  }
}

function addProduct() {
  let reader = new FileReader();
  reader.onload = function(e) {
    products.push({
      name: newName.value,
      price: parseFloat(newPrice.value),
      stock: parseInt(newStock.value),
      image: e.target.result
    });
    renderProducts();
    renderInventory();
  };
  if (newImage.files[0]) reader.readAsDataURL(newImage.files[0]);
}

function renderInventory() {
  inventoryList.innerHTML = "";
  products.forEach((p, i) => {
    inventoryList.innerHTML += `
      <div class="inventory-item">
        <img src="${p.image}"><br>
        <b>${p.name}</b><br>
        Stock: <input type="number" value="${p.stock}" onchange="updateStock(${i},this.value)">
        <button onclick="deleteProduct(${i})">Delete</button>
      </div>`;
  });
}

function updateStock(i, val) {
  products[i].stock = parseInt(val);
  renderProducts();
}

function deleteProduct(i) {
  products.splice(i, 1);
  cart = cart.filter(item => item.index !== i);
  renderProducts();
  renderInventory();
  updateCart();
}

function openCart() {
  overlay.classList.add("active");
  cartDrawer.classList.add("active");
  updateCart();
}

function closeCart() {
  overlay.classList.remove("active");
  cartDrawer.classList.remove("active");
}

function searchProducts() {
  let val = searchInput.value.toLowerCase();
  document.querySelectorAll(".product").forEach(p => {
    p.style.display = p.innerText.toLowerCase().includes(val) ? "block" : "none";
  });
}
</script>
</body>
</html>
